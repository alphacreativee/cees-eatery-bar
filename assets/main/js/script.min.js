import{preloadImages}from"../../libs/utils.js";$=jQuery;let lenis=new Lenis;function headerMobile(){if(!(991<window.innerWidth)){let e=document.getElementById("btn-hambuger"),t=document.querySelector(".header-menu-mobile"),n=document.querySelectorAll(".menu-item-has-children");var i=document.querySelector(".menu-mobile-overlay");e.addEventListener("click",function(){t.classList.toggle("active"),e.classList.toggle("active")}),i.addEventListener("click",function(){t.classList.remove("active"),e.classList.remove("active")}),n.forEach(t=>{let i=t.querySelector(".sub-menu");t.classList.contains("active")||(i.style.height="0px"),t.addEventListener("click",function(e){e.preventDefault();e=this.classList.contains("active");n.forEach(e=>{e!==this&&(e.classList.remove("active"),(e=e.querySelector(".sub-menu")).style.height=e.scrollHeight+"px",e.style.height="0px")}),this.classList.toggle("active"),e?(i.style.height=i.scrollHeight+"px",i.offsetHeight,i.style.height="0px"):(i.style.height=i.scrollHeight+"px",i.addEventListener("transitionend",function e(){t.classList.contains("active")&&(i.style.height="auto"),i.removeEventListener("transitionend",e)}))})})}}function swiperOffer(){document.querySelector(".swiper-offer")&&new Swiper(".swiper-offer",{slidesPerView:1,spaceBetween:20,navigation:{nextEl:".offer-list .swiper-button-next",prevEl:".offer-list .swiper-button-prev"},breakpoints:{991:{slidesPerView:3,spaceBetween:30}}})}function getDate(){document.querySelector("#date")&&new Lightpick({field:document.getElementById("date")})}function customDropdown(){let e=document.querySelectorAll(".dropdown-custom, .dropdown-custom-select");function l(n){e.forEach(e=>{var t=e.querySelector(".dropdown-custom-menu"),i=e.querySelector(".dropdown-custom-btn");n&&e===n||(t.classList.remove("dropdown--active"),i.classList.remove("--active"))})}e.forEach(o=>{let t=o.querySelector(".dropdown-custom-btn"),i=o.querySelector(".dropdown-custom-menu");var e=o.querySelectorAll(".dropdown-custom-item");let s=o.querySelector(".value-select"),r=o.querySelector(".dropdown-custom-text"),c=o.classList.contains("dropdown-custom-select");t.addEventListener("click",function(e){e.stopPropagation(),l(o),i.classList.toggle("dropdown--active"),t.classList.toggle("--active")}),document.addEventListener("click",function(){l()}),e.forEach(n=>{n.addEventListener("click",function(e){var t,i;e.stopPropagation(),c?(e=n.textContent,r.textContent=e,o.classList.add("selected")):(e=(e=s.querySelector("img"))?e.src:"",t=s.querySelector("span").textContent,i=n.innerHTML,s.innerHTML=i,"Time"!==t.trim()&&(n.innerHTML=e?`<span>${t}</span><img src="${e}" alt="" />`:`<span>${t}</span>`)),l()})}),window.addEventListener("scroll",function(){i.closest(".header-lang")&&(i.classList.remove("dropdown--active"),t.classList.remove("--active"))})})}function fieldSuggestion(){function i(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ/g,"d").replace(/Đ/g,"D")}function n(e,t){e.find("li").each(function(){var e=i($(this).text().toLowerCase());$(this).toggle(e.includes(t))})}$(".field-suggestion input").on("focus",function(){var e=$(this).siblings(".field-suggestion__list");$(".field-suggestion__list").addClass("hidden"),e.removeClass("hidden"),n(e,"")}),$(".field-suggestion input").on("input",function(){var e=i($(this).val().toLowerCase()),t=$(this).siblings(".field-suggestion__list");n(t,e),t.removeClass("hidden")}),$(".field-suggestion").on("click","li",function(){var e=$(this).text();$(this).closest(".field-suggestion").find("input").val(e),$(this).parent().addClass("hidden")}),$(document).on("click",function(e){$(e.target).closest(".field-suggestion").length||$(".field-suggestion__list").addClass("hidden")})}function initStickyBar(){let t=document.querySelector(".form-search-bar");t&&gsap.to(t,{scrollTrigger:{trigger:t,start:"top center",end:"+=500",scrub:!0,onUpdate:e=>{e=e.progress,e=gsap.utils.interpolate(window.innerHeight/2-t.offsetHeight/2,106,e);t.style.top=e+"px"}}})}function CTAMobile(){if(!(992<window.innerWidth)){let i=document.getElementById("cta-mobile");var e=document.querySelector("footer");if(i&&e){let t=!1;ScrollTrigger.create({trigger:e,start:"top bottom",end:"bottom bottom",onEnter:()=>{t=!0,i.classList.add("hidden")},onLeaveBack:()=>{t=!1,i.classList.remove("hidden")}}),ScrollTrigger.create({trigger:"body",start:"top top",end:"bottom bottom",onUpdate:e=>{t||(1===e.direction?i.classList.add("hidden"):-1===e.direction&&i.classList.remove("hidden"))}})}}}lenis.on("scroll",ScrollTrigger.update),gsap.ticker.add(e=>{lenis.raf(1e3*e)}),gsap.ticker.lagSmoothing(0);let init=()=>{gsap.registerPlugin(ScrollTrigger),headerMobile(),swiperOffer(),getDate(),customDropdown(),fieldSuggestion(),initStickyBar(),CTAMobile()},isLinkClicked=(preloadImages("img").then(()=>{init()}),!1);$("a").on("click",function(e){!this.href||this.href.match(/^#/)||this.href.match(/^javascript:/)||(isLinkClicked=!0,console.log("1"))}),$(window).on("beforeunload",function(){isLinkClicked||$(window).scrollTop(0),isLinkClicked=!1});