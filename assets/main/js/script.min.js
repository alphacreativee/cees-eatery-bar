import{preloadImages}from"../../libs/utils.js";$=jQuery;let lenis=new Lenis;function headerMobile(){if(!(991<window.innerWidth)){let e=document.getElementById("btn-hambuger"),t=document.querySelector(".header-menu-mobile"),o=document.querySelectorAll(".menu-item-has-children");var n=document.querySelector(".menu-mobile-overlay");e.addEventListener("click",function(){t.classList.toggle("active"),e.classList.toggle("active")}),n.addEventListener("click",function(){t.classList.remove("active"),e.classList.remove("active")}),o.forEach(n=>{let i=n.querySelector(".sub-menu");n.classList.contains("active")||(i.style.height="0px"),n.addEventListener("click",function(e){var t=this.classList.contains("active");o.forEach(e=>{e!==this&&(e.classList.remove("active"),(e=e.querySelector(".sub-menu")).style.height=e.scrollHeight+"px",e.style.height="0px")}),this.classList.toggle("active"),t?(i.style.height=i.scrollHeight+"px",i.offsetHeight,i.style.height="0px"):(i.style.height=i.scrollHeight+"px",i.addEventListener("transitionend",function e(){n.classList.contains("active")&&(i.style.height="auto"),i.removeEventListener("transitionend",e)}))})})}}function swiperOffer(){document.querySelector(".swiper-offer")&&new Swiper(".swiper-offer",{slidesPerView:1,spaceBetween:20,navigation:{nextEl:".offer-list .swiper-button-next",prevEl:".offer-list .swiper-button-prev"},breakpoints:{991:{slidesPerView:3,spaceBetween:30}}})}function getDate(){var e;document.querySelector("#date")&&(e=moment().add(1,"day"),new Lightpick({field:document.getElementById("date"),singleDate:!0,minDate:e,onSelect:function(e){e&&(e=e.format("DD-MM-YYYY"),document.querySelector('input[name="form_date"]').value=e)}}))}function customDropdown(){let e=document.querySelectorAll(".dropdown-custom, .dropdown-custom-select");function l(i){e.forEach(e=>{var t=e.querySelector(".dropdown-custom-menu"),n=e.querySelector(".dropdown-custom-btn");i&&e===i||(t.classList.remove("dropdown--active"),n.classList.remove("--active"))})}e.forEach(o=>{let t=o.querySelector(".dropdown-custom-btn"),n=o.querySelector(".dropdown-custom-menu");var e=o.querySelectorAll(".dropdown-custom-item");let a=o.querySelector(".value-select"),r=o.querySelector(".dropdown-custom-text"),s=o.classList.contains("dropdown-custom-select");t.addEventListener("click",function(e){e.stopPropagation(),l(o),n.classList.toggle("dropdown--active"),t.classList.toggle("--active")}),document.addEventListener("click",function(){l()}),e.forEach(i=>{i.addEventListener("click",function(e){e.stopPropagation();var t,n,e=$(this);s?(t=i.textContent,r.textContent=t,e.attr("data-value")&&(r.textContent=t,o.setAttribute("data-value",e.attr("data-value"))),o.classList.add("selected")):(e=(t=a.querySelector("img"))?t.src:"",t=a.querySelector("span").textContent,n=i.innerHTML,a.innerHTML=n,"Time"!==t.trim()&&(i.innerHTML=e?`<span>${t}</span><img src="${e}" alt="" />`:`<span>${t}</span>`)),l()})}),window.addEventListener("scroll",function(){n.closest(".header-lang")&&(n.classList.remove("dropdown--active"),t.classList.remove("--active"))})})}function fieldSuggestion(){function n(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ/g,"d").replace(/Đ/g,"D")}function i(e,t){e.find("li").each(function(){var e=n($(this).text().toLowerCase());$(this).toggle(e.includes(t))})}$(".field-suggestion input").on("focus",function(){var e=$(this).siblings(".field-suggestion__list");$(".field-suggestion__list").addClass("hidden"),e.removeClass("hidden"),i(e,"")}),$(".field-suggestion input").on("input",function(){var e=n($(this).val().toLowerCase()),t=$(this).siblings(".field-suggestion__list");i(t,e),t.removeClass("hidden")}),$(".field-suggestion").on("click","li",function(){var e=$(this).text();$(this).closest(".field-suggestion").find("input").val(e),$(this).parent().addClass("hidden")}),$(document).on("click",function(e){$(e.target).closest(".field-suggestion").length||$(".field-suggestion__list").addClass("hidden")})}function initStickyBar(){let t=document.querySelector(".form-search-bar");t&&gsap.to(t,{scrollTrigger:{trigger:t,start:"top center",end:"+=500",scrub:!0,onUpdate:e=>{e=e.progress,e=gsap.utils.interpolate(window.innerHeight/2-t.offsetHeight/2,106,e);t.style.top=e+"px"}}})}function CTAMobile(){if(!(992<window.innerWidth)){let n=document.getElementById("cta-mobile");var e=document.querySelector("footer");if(n&&e){let t=!1;ScrollTrigger.create({trigger:e,start:"top bottom",end:"bottom bottom",onEnter:()=>{t=!0,n.classList.add("hidden")},onLeaveBack:()=>{t=!1,n.classList.remove("hidden")}}),ScrollTrigger.create({trigger:"body",start:"top top",end:"bottom bottom",onUpdate:e=>{t||(1===e.direction?n.classList.add("hidden"):-1===e.direction&&n.classList.remove("hidden"))}})}}}function handlePageVisibilityAndFavicon(){let e=document.title,i,o=!1;function a(e){let t=document.querySelector("link[rel~='icon']");t||((t=document.createElement("link")).rel="icon",t.type="image/svg+xml",document.head.appendChild(t)),t.href=e+"?v="+(new Date).getTime()}document.addEventListener("visibilitychange",function(){if(document.hidden){if(document.title="Cee's Restaurant & Bar",!o){o=!0;var n=window.location.origin;let e=[n+"/wp-content/themes/cees/assets/images/icon/favicon-black.svg",n+"/wp-content/themes/cees/assets/images/icon/favicon-gray.svg"],t=0;i=setInterval(()=>{a(e[t]),t=(t+1)%e.length},500)}}else document.title=e,clearInterval(i),o=!1,a(window.location.origin+"/wp-content/themes/cees/assets/images/icon/favicon-black.svg")})}function formReservation(){let c=$(".reservation-form form");c.length<1||c.on("submit",function(e){e.preventDefault();var e=c.find("input[name='fullname']"),t=c.find("input[name='phone']"),n=c.find("input[name='email']"),i=c.find("input[name='guest']");let o=c.find("button[type='submit']");var a,r=o.attr("email-recipient");c.find(".input-wrapper").removeClass("error"),c.find(".contact-message").remove();let s=!0;function l(e){e=c.find(e);if(!(e.find(".dropdown-custom-select.selected").length<1))return 1;e.addClass("error")}""===e.val().trim()&&(e.closest(".input-wrapper").addClass("error"),s=!1),""===t.val().trim()&&(t.closest(".input-wrapper").addClass("error"),s=!1),""===n.val().trim()&&(n.closest(".input-wrapper").addClass("error"),s=!1),i.val()&&""!==i.val().trim()||(i.closest(".input-wrapper").addClass("error"),s=!1),l(".input-wrapper.time")||(s=!1),(s=l(".input-wrapper.select-event")?s:!1)&&((a=new FormData).append("action","submit_reservation_form"),a.append("name",e.val().trim()),a.append("phone",t.val().trim()),a.append("email",n.val().trim()),a.append("guest",i.val().trim()),a.append("time",c.find(".input-wrapper.time .dropdown-custom-select.selected .dropdown-custom-text").text().trim()),a.append("event",c.find(".input-wrapper.select-event .dropdown-custom-select.selected .dropdown-custom-text").text().trim()),a.append("email_recipient",r?r.trim():""),$.ajax({url:ajaxUrl,type:"POST",data:a,processData:!1,contentType:!1,beforeSend:function(){o.addClass("aloading")},success:function(e){c[0].reset(),o.removeClass("aloading"),$("#modalSuccess").modal("show")},error:function(){c.append('<span class="contact-message body-sm-regular d-block" style="color:#F00;margin-top: 10px;">Something went wrong. Please try again later.</span>'),o.removeClass("aloading")}}))})}function uploadPdf(){let o=$("form").find(".pdf-note"),a=o.text();$("input[name='upload']").on("change",function(){var e,t=this.files[0],n=$(this),i=n.siblings(".text-file");n.removeClass("error"),i.text("Upload file under 5MB"),o&&o.text(a),t&&(["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","image/jpeg","image/png"].includes(t.type)?5242880<t.size?(n.addClass("error"),n.val(""),o&&o.text("File too large (max 5MB)")):(t=t.name,e=35,t=(e=(e=t.length>e?t.slice(0,e)+"...":t).toLowerCase()).charAt(0).toUpperCase()+e.slice(1),i.text(t),i.addClass("has-file")):(n.addClass("error"),n.val(""),o&&o.text("Only PDF/DOC/DOCX/JPG/PNG files allowed")))})}function formReruitment(){let d=$("#formReruitment");d.length<1||d.on("submit",function(e){e.preventDefault();var e=d.find("input[name='fullname']"),t=d.find("input[name='phone']"),n=d.find("input[name='email']"),i=d.find("input[type='file']"),o=d.find("textarea[name='note']");let a=d.find("button[type='submit']");var r,s=a.attr("job-id"),l=a.attr("email-recipient");d.find(".field-item").removeClass("error"),d.find(".contact-message").remove();let c=!0;""===e.val().trim()&&(e.closest(".form-row").addClass("error"),c=!1),""===t.val().trim()&&(t.closest(".form-row").addClass("error"),c=!1),""===n.val().trim()&&(n.closest(".form-row").addClass("error"),c=!1),c&&((r=new FormData).append("action","submit_recruitment_form"),r.append("name",e.val().trim()),r.append("phone",t.val().trim()),r.append("email",n.val().trim()),r.append("file",i.get(0).files[0]),r.append("message",o.val().trim()),r.append("job_id",s),r.append("email_recipient",l.trim()),$.ajax({url:ajaxUrl,type:"POST",data:r,processData:!1,contentType:!1,beforeSend:function(){a.addClass("aloading")},success:function(e){d[0].reset();d.find(".up-file .text-file").text("");a.removeClass("aloading"),$("#modalSuccess").modal("show")},error:function(){d.append('<span class="contact-message body-sm-regular" style="color:#F00;">Có lỗi xảy ra, vui lòng thử lại sau.</span>'),a.removeClass("aloading")}}))})}function searchReruitment(){function t(e=1){var t=$("#formSearchCareer");let n=t.find('button[type="submit"]');e={action:"filter_career",career_title:t.find('input[name="career_title"]').val(),job_type:t.find(".form-item.time .dropdown-custom-select").attr("data-value")||"",service:t.find(".form-item.service .dropdown-custom-select").attr("data-value")||"",paged:e};console.log(t.find(".form-item.service .dropdown-custom-select")),$.ajax({url:ajaxUrl,type:"POST",data:e,beforeSend:function(){n.addClass("aloading")},success:function(e){e.success&&($(".result-form-wrapper").html(e.data.html),$(".pagination").html(e.data.pagination)),n.removeClass("aloading")},error:function(){alert("Có lỗi xảy ra, vui lòng thử lại."),n.removeClass("aloading")}})}$("#formSearchCareer").on("submit",function(e){e.preventDefault(),t(1)}),$(document).on("click",".pagination a.page-number",function(e){e.preventDefault(),t($(this).data("page"))})}lenis.on("scroll",ScrollTrigger.update),gsap.ticker.add(e=>{lenis.raf(1e3*e)}),gsap.ticker.lagSmoothing(0),document.addEventListener("DOMContentLoaded",()=>{handlePageVisibilityAndFavicon()});let init=()=>{gsap.registerPlugin(ScrollTrigger),headerMobile(),swiperOffer(),getDate(),customDropdown(),fieldSuggestion(),initStickyBar(),CTAMobile(),formReservation(),uploadPdf(),formReruitment(),searchReruitment()},isLinkClicked=(preloadImages("img").then(()=>{init()}),!1);$("a").on("click",function(e){!this.href||this.href.match(/^#/)||this.href.match(/^javascript:/)||(isLinkClicked=!0,console.log("1"))}),$(window).on("beforeunload",function(){isLinkClicked||$(window).scrollTop(0),isLinkClicked=!1});